#!/bin/sh
# Fast auto-format and lint before committing

# 1) Format (does not run tests)
mvn -q -DskipTests spotless:apply ktlint:check || exit 1

# 2) Re-stage any files changed by formatting
git add -A

# 3) Verify formatting + linting (fail commit if issues remain)
mvn -q -DskipTests verify || {
  echo "Commit blocked: fix formatting/lint issues (see output above)."
  exit 1
}

echo "Formatting & lint OK."